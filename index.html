<!DOCTYPE html>
<html>

<head>
    <script src="jquery.js"></script>
</head>

<body>
    <form id="file_selector" style="border:2px solid #008b8b; margin-left: 15%;max-width: 718px; padding-left: 82px">

        </br>
        <div>
            <p> <b>PLEASE CHOOSE A FILE WITH THE OBJECT:</b>
                <input type="file" name="file" id="file" />
            </P>
        </div>
        </br>
    </form>

    <canvas id="myCanvas" width="800" height="800" style="border:2px solid #008b8b; margin-left: 15%"></canvas>

    <script>
        var vertexInfo = [];
        var connectionInfo = [];

        var canvas = document.getElementById('myCanvas');

        $(function() {
            document.getElementById('file').onchange = function() {
                var ctx = canvas.getContext("2d");

                var centerX = canvas.width / 2;
                var centerY = canvas.height / 2;

                var file = this.files[0];
                var reader = new FileReader();
                //preberi datoteko
                reader.onload = function(progressEvent) {

                    var lines = this.result.split('\n');
                    var list = new Array();
                    for (var line = 0; line < lines.length; line++) {
                        list.push(lines[line]);
                    }

                    window.connectionInfo.length = (lines.length - 1) / 2
                    global_length = window.connectionInfo.length;

                    //Obema globalnima array-ema vsako polje definiram kot array
                    //da lahko kasneje noter pusham kreirane arraye                    
                    for (var i = 0; i < connectionInfo.length; i++) {
                        window.vertexInfo[i] = new Array();
                    }
                    for (var i = 0; i < connectionInfo.length; i++) {
                        window.connectionInfo[i] = new Array();
                    }
                    var povezave = new Array();
                    var koordinate = new Array();
                    var stevecPovezav = 0;
                    var stevecInfo = 0;
                    for (var i = 0; i < lines.length; i++) {
                        var lineInfo = lines[i].split(" ");
                        var line_length = lineInfo.length;
                        var temp = new Array();
                        temp.length = line_length - 1;

                        //console.log("LineInfo = " + lineInfo);
                        if (lines[i][0] == 'v') {

                            // Dobim array temp, ki vsebuje info o koordinatah vozlisca
                            for (var j = 1; j < line_length; j++) {
                                temp[j - 1] = lineInfo[j];
                            }
                            // console.log("type of global array connectionInfo = " + typeof(vertexInfo[0]));
                            window.vertexInfo[stevecInfo].push(temp);
                            // Povecam stevec global array-a, ki hrani informacije o vseh koordinatah vseh vozlisch
                            stevecInfo++;
                        } else if (lines[i][0] == 'f') {
                            for (var j = 1; j < line_length; j++) {
                                temp[j - 1] = lineInfo[j];
                            }
                            // console.log("temp povezave = " + temp);
                            window.connectionInfo[stevecPovezav].push(temp);
                            stevecPovezav++;
                            //console.log("type elementa temp pri povezavah = " + typeof(temp));
                        }

                    }

                     for (var i = 0; i < window.vertexInfo.length; i++) {
                        // console.log(window.vertexInfo[i]);
                        for (var j = 0; j < window.vertexInfo[i].length; j++) {
                            console.log(parseFloat(window.vertexInfo[i][j]));
                        }
                    }
                    /*
                    ctx.beginPath();
                    for (var i = 0; i < window.vertexInfo.length; i++) {
                        if (i == 0) {
                            console.log("sem v i = 0");
                            console.log("koordinata x = " + centerX + parseFloat(window.vertexInfo[i][0]));
                            console.log("koordinata y = " + centerY + parseFloat(window.vertexInfo[i][1]));
                            ctx.moveTo(centerX + parseFloat(window.vertexInfo[i][0]), centerY + parseFloat(window.vertexInfo[i][1]));
                        } else {
                            console.log("sem v i = " + i);
                            console.log("koordinata x = " + centerX + parseFloat(window.vertexInfo[i][0]));
                            console.log("koordinata y = " + centerY + parseFloat(window.vertexInfo[i][1]));
                            ctx.lineTo(centerX + parseFloat(window.vertexInfo[i][0]), centerY + parseFloat(window.vertexInfo[i][1]));
                        }
                    }
                    ctx.stroke();
                    */

                };
                reader.readAsText(file);
            };
        });
    </script>


</body>

</html>
